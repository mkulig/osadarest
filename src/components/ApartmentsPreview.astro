---
type Amenity = {
	icon?: string;
	label: string;
};

export type ApartmentItem = {
	title: string;
	description: string;
	slug: string;
	featured: boolean;
	order: number;
	color: string;

	capacity: number;
	areaM2: number;
	beds: string;

	priceFrom: number;
	currency: string;
	amenities: Amenity[];

	cover: ImageMetadata;
	coverAlt: string;
	gallery: {
		src: ImageMetadata;
		alt: string;
	}[];

	// SEO
	seoTitle?: string;
	seoDescription?: string;
	canonical?: string;
};

interface Props {
	title: string;
	subtitle: string;
	items: ApartmentItem[];
}

import { Image } from "astro:assets";

const { title, subtitle, items } = Astro.props;
---

<section aria-labelledby="apartments-heading" class="py-10 sm:py-12 ">
  <div class="mx-auto container px-4 sm:px-6 lg:px-8">
    <div class="mx-auto max-w-2xl text-center">
      <h2 id="apartments-heading" class="text-2xl font-semibold tracking-tight text-gray-900 sm:text-3xl">
          {title}
      </h2>
      <p class="mt-2 text-gray-700">{subtitle}</p>
    </div>


    <div class="mt-8 grid grid-cols-1 gap-6 sm:mt-10 lg:grid-cols-3">
      {items.map((it) => {
        const url = `apartamenty/${it.slug}`;

        return (
          <article class="group flex flex-col overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm transition hover:shadow-md">
            <a href={url} class="relative block aspect-[4/3] w-full overflow-hidden">
              <picture>
                  <Image
                  src={it.cover}
                  alt={it.coverAlt}
                  loading="lazy"
                  decoding="async"
                  class="h-full w-full object-cover transition duration-300 group-hover:scale-[1.02]"
                  width="1200"
                  height="900"
                  sizes="(max-width: 1024px) 100vw, 33vw"
                />
              </picture>
              {it.priceFrom && it.currency && (
                <div class="absolute left-3 top-3 rounded-md bg-white/90 px-2 py-1 text-xs font-semibold text-gray-900 shadow-sm">
                  od {it.priceFrom} {it.currency}/noc
                </div>
              )}
            </a>

            <div class="flex flex-1 flex-col p-4">
              <header>
                <h3 class="text-2xl font-semibold text-gray-900">
                  <a href={url} class={`hover:underline underline-offset-2 text-${it.color}`}>{it.title}</a>
                </h3>
                <p class="text-gray-500 text-sm pb-2">{it.description}</p>

                <div class="mt-1 flex flex-wrap items-center justify-between gap-x-3 gap-y-1 text-sm text-gray-700">
                  {typeof it.capacity === "number" && <strong title="Liczba go≈õci">üë• {it.capacity} os.</strong>}
                  {it.beds && <strong title="Typy ≈Ç√≥≈ºek">üõèÔ∏è {it.beds}</strong>}
                  {typeof it.areaM2 === "number" && <strong title="Metra≈º">üìê {it.areaM2} m¬≤</strong>}
                </div>
              </header>

            <hr class="my-2 text-gray-200"/>

              {it.amenities?.length ? (
                <ul class="grid grid-cols-2 gap-2 text-sm text-gray-700">
                  {it.amenities.slice(0, 10).map((a) => (
                    <li class="flex items-center gap-2">
                      {a.icon && <span class="leading-none" aria-hidden="true">{a.icon}</span>}
                      <span>{a.label}</span>
                    </li>
                  ))}
                </ul>
              ) : null}

              <div class="mt-4 flex items-center justify-between">
                {it.priceFrom && it.currency ? (
                  <p class="text-base font-semibold text-gray-900">
                    <span class="mr-1 align-middle">od</span>
                    <span class="align-middle">{it.priceFrom} {it.currency}</span>
                    <span class="ml-1 text-sm font-normal text-gray-600">/ noc</span>
                  </p>
                ) : <span />}

                <a
                  href={url}
                  class="inline-flex items-center rounded-lg border border-gray-900 px-3 py-2 text-sm font-semibold text-gray-900 transition hover:bg-gray-900 hover:text-white focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"
                >
                  Zobacz szczeg√≥≈Çy
                </a>
              </div>
            </div>
          </article>
        );
      })}
    </div>
  </div>
</section>
